# Docker安装MySQL

官方Docker hub中的MySQL镜像地址：[MySQL镜像](https://hub.docker.com/_/mysql)

## 一、下载镜像

下载 MySQL 8.0.18 版本的镜像：

```bash
docker pull mysql:8.0.18
```

## 二、运行容器

创建一个文件夹存放MySQL配置文件、日志、数据等（挂载目录，作用是此目录中的文件或文件夹覆盖掉容器内部的文件或文件夹）

```bash
cd ~
mkdir mysql
cd mysql
mkdir data
```

启动MySQL容器

```bash
docker run -it -d -p 3306:3306 --name docker_mysql_8.0.18 -v "$PWD/data":/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 mysql:8.0.18
```

启动容器命令解释：

> -d：后台启动
> -p：表示端口映射，冒号左面的是我们的宿主机的端口，也就是我们虚拟机的端口，而右侧则表示的是mysql容器内的端口
> --name：是我们给mysql容器取的名字
> -v：表示挂载路径，映射主机路径到容器，$PWD表示当前目录下，冒号左面的表示我们宿主机的挂载目录，也就是我们虚拟机所在的文件路径，冒号右边则表是的是mysql容器在容器内部的路径，上面的命令我分别挂载了my.cnf(mysql的配置文件)，如需使用配置文件的方式启动mysql，这里则需要加上，mysql的日志，还有mysql存放数据所在的目录
> -e 设置环境变量，这里设置了MySQL密码
> 最后是镜像名

除了以上的启动参数，启动docker中MySQL时还可以添加以下参数：

> --restart=always 跟随docker启动
> --privileged=true 容器root用户享有主机root用户权限
> --lower_case_table_names=1 设置表名参数名等忽略大小写

## 三、修改MySQL配置

进入容器：

```bash
docker exec -it docker_mysql_8.0.18 bash
```

进入到容器内后，使用mysql命令连接数据库

```bash
mysql -uroot -p
```

输入密码后，进入mysql命令行界面，开始设置远程的授权等信息

```sql
grant all privileges on *.* to root@"%" identified by "123456" with grant option;

#新版的的mysql版本已经将创建账户和赋予权限的方式分开了
#赋予权限:grant 权限列表 on 数据库 to '用户名'@'访问主机';(修改权限时在后面加with grant option)
#grant all privileges on *.* to root@"%" with grant option;

ALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY '123456';
ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';
  
flush privileges;
```
